<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.11: http://docutils.sourceforge.net/" />
<title>Tn5 deep mutational scanning by Melnikov et al (2014)</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7614 2013-02-21 15:55:51Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
<style type="text/css">

/*
*   math2html: convert LaTeX equations to HTML output.
*
*   Copyright (C) 2009,2010 Alex Fern√°ndez
*
*   Released under the terms of the `2-Clause BSD license'_, in short:
*   Copying and distribution of this file, with or without modification,
*   are permitted in any medium without royalty provided the copyright
*   notice and this notice are preserved.
*   This file is offered as-is, without any warranty.
*
* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause
*
*   Based on eLyXer: convert LyX source files to HTML output.
*   http://elyxer.nongnu.org/
*/
/* --end--
* CSS file for LaTeX formulas.
*/

/* Formulas */
.formula {
	text-align: center;
	font-family: "Droid Serif", "DejaVu Serif", "STIX", serif;
	margin: 1.2em 0;
}
span.formula {
	white-space: nowrap;
}
div.formula {
	padding: 0.5ex;
	margin-left: auto;
	margin-right: auto;
}

/* Basic features */
a.eqnumber {
	display: inline-block;
	float: right;
	clear: right;
	font-weight: bold;
}
span.unknown {
	color: #800000;
}
span.ignored, span.arraydef {
	display: none;
}
.formula i {
	letter-spacing: 0.1ex;
}

/* Alignment */
.align-left, .align-l {
	text-align: left;
}
.align-right, .align-r {
	text-align: right;
}
.align-center, .align-c {
	text-align: center;
}

/* Structures */
span.overline, span.bar {
	text-decoration: overline;
}
.fraction, .fullfraction {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
}
.fraction .fraction {
	font-size: 80%;
	line-height: 100%;
}
span.numerator {
	display: block;
}
span.denominator {
	display: block;
	padding: 0ex;
	border-top: thin solid;
}
sup.numerator, sup.unit {
	font-size: 70%;
	vertical-align: 80%;
}
sub.denominator, sub.unit {
	font-size: 70%;
	vertical-align: -20%;
}
span.sqrt {
	display: inline-block;
	vertical-align: middle;
	padding: 0.1ex;
}
sup.root {
	font-size: 70%;
	position: relative;
	left: 1.4ex;
}
span.radical {
	display: inline-block;
	padding: 0ex;
	font-size: 150%;
	vertical-align: top;
}
span.root {
	display: inline-block;
	border-top: thin solid;
	padding: 0ex;
	vertical-align: middle;
}
span.symbol {
	line-height: 125%;
	font-size: 125%;
}
span.bigsymbol {
	line-height: 150%;
	font-size: 150%;
}
span.largesymbol {
	font-size: 175%;
}
span.hugesymbol {
	font-size: 200%;
}
span.scripts {
	display: inline-table;
	vertical-align: middle;
}
.script {
	display: table-row;
	text-align: left;
	line-height: 150%;
}
span.limits {
	display: inline-table;
	vertical-align: middle;
}
.limit {
	display: table-row;
	line-height: 99%;
}
sup.limit, sub.limit {
	line-height: 100%;
}
span.symbolover {
	display: inline-block;
	text-align: center;
	position: relative;
	float: right;
	right: 100%;
	bottom: 0.5em;
	width: 0px;
}
span.withsymbol {
	display: inline-block;
}
span.symbolunder {
	display: inline-block;
	text-align: center;
	position: relative;
	float: right;
	right: 80%;
	top: 0.3em;
	width: 0px;
}

/* Environments */
span.array, span.bracketcases, span.binomial, span.environment {
	display: inline-table;
	text-align: center;
	border-collapse: collapse;
	margin: 0em;
	vertical-align: middle;
}
span.arrayrow, span.binomrow {
	display: table-row;
	padding: 0ex;
	border: 0ex;
}
span.arraycell, span.bracket, span.case, span.binomcell, span.environmentcell {
	display: table-cell;
	padding: 0ex 0.2ex;
	line-height: 99%;
	border: 0ex;
}
/*
* CSS file for LaTeX formulas, extra stuff:
* binomials, vertical braces, stackrel, fonts and colors.
*/

/* Inline binomials */
span.binom {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
	font-size: 80%;
}
span.binomstack {
	display: block;
	padding: 0em;
}

/* Over- and underbraces */
span.overbrace {
	border-top: 2pt solid;
}
span.underbrace {
	border-bottom: 2pt solid;
}

/* Stackrel */
span.stackrel {
	display: inline-block;
	text-align: center;
}
span.upstackrel {
	display: block;
	padding: 0em;
	font-size: 80%;
	line-height: 64%;
	position: relative;
	top: 0.15em;

}
span.downstackrel {
	display: block;
	vertical-align: bottom;
	padding: 0em;
}

/* Fonts */
span.mathsf, span.textsf {
	font-style: normal;
	font-family: sans-serif;
}
span.mathrm, span.textrm {
	font-style: normal;
	font-family: serif;
}
span.text, span.textnormal {
	font-style: normal;
}
span.textipa {
	color: #008080;
}
span.fraktur {
	font-family: "Lucida Blackletter", eufm10, blackletter;
}
span.blackboard {
	font-family: Blackboard, msbm10, serif;
}
span.scriptfont {
	font-family: "Monotype Corsiva", "Apple Chancery", "URW Chancery L", cursive;
	font-style: italic;
}

/* Colors */
span.colorbox {
	display: inline-block;
	padding: 5px;
}
span.fbox {
	display: inline-block;
	border: thin solid black;
	padding: 2px;
}
span.boxed, span.framebox {
	display: inline-block;
	border: thin solid black;
	padding: 5px;
}


</style>
</head>
<body>
<div class="document" id="tn5-deep-mutational-scanning-by-melnikov-et-al-2014">
<h1 class="title">Tn5 deep mutational scanning by Melnikov et al (2014)</h1>

<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id1">Overview</a></li>
<li><a class="reference internal" href="#input-data" id="id2">Input data</a></li>
<li><a class="reference internal" href="#inference-of-site-specific-amino-acid-preferences" id="id3">Inference of site-specific amino-acid preferences</a></li>
<li><a class="reference internal" href="#testing-of-inference-of-site-specific-preferences-on-simulated-data" id="id4">Testing of inference of site-specific preferences on simulated data</a></li>
<li><a class="reference internal" href="#testing-of-inference-of-differential-preferences-on-simulated-data" id="id5">Testing of inference of differential preferences on simulated data</a></li>
</ul>
</div>
<div class="section" id="overview">
<h1><a class="toc-backref" href="#id1">Overview</a></h1>
<p><a class="reference external" href="http://nar.oxfordjournals.org/content/42/14/e112">Melnikov et al (2014)</a> perform deep mutational scanning on a Tn5 transposon. In this directory, <a class="reference external" href="https://github.com/jbloom/dms_tools">dms_tools</a> is used to analyze their data.</p>
<p>This analysis demonstrates the use of <a class="reference external" href="https://github.com/jbloom/dms_tools">dms_tools</a> to infer and visualize site-specific preferences.</p>
<p>The analysis then tests the performance of <a class="reference external" href="https://github.com/jbloom/dms_tools">dms_tools</a> preference and differential inferences on data simulated based on data from <a class="reference external" href="http://nar.oxfordjournals.org/content/42/14/e112">Melnikov et al (2014)</a>.</p>
</div>
<div class="section" id="input-data">
<h1><a class="toc-backref" href="#id2">Input data</a></h1>
<p>The following input data files are used by the scripts in this directory to generate all output:</p>
<blockquote>
<ul>
<li><p class="first"><tt class="docutils literal">./raw_data/</tt> : this directory contains the raw deep mutational scanning counts data from <a class="reference external" href="http://nar.oxfordjournals.org/content/42/14/e112">Melnikov et al (2014)</a> as provided in Supplementary Data 2 of that paper (that supplementary data is a ZIP file, this directory simply contains the contents of the unzipped file).</p>
</li>
<li><p class="first"><tt class="docutils literal">./PDB_structure/</tt> contains information about the relative solvent accessibilities and secondary structures of the Tn5 transposon based on an analysis of the PDB structure with <tt class="docutils literal">DSSP</tt>. Specifically:</p>
<blockquote>
<ul class="simple">
<li><tt class="docutils literal">SSs.txt</tt> classifies the secondary structures.</li>
<li><tt class="docutils literal">RSAs.txt</tt> classifies the relative solvent accessibilities.</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</div>
<div class="section" id="inference-of-site-specific-amino-acid-preferences">
<h1><a class="toc-backref" href="#id3">Inference of site-specific amino-acid preferences</a></h1>
<p>Within this directory, the shell script <tt class="docutils literal">infer_prefs</tt> infers the site-specific preferences using <a class="reference external" href="https://github.com/jbloom/dms_tools">dms_tools</a>. The script can simply be run at the command line with:</p>
<pre class="literal-block">
./infer_prefs
</pre>
<p>The script performs the following steps:</p>
<blockquote>
<ol class="arabic simple">
<li>Use the custom <tt class="docutils literal">Python</tt> script <tt class="docutils literal">process_raw_to_dms_counts.py</tt> to convert the raw data files of <a class="reference external" href="http://nar.oxfordjournals.org/content/42/14/e112">Melnikov et al (2014)</a> found in <tt class="docutils literal">./raw_data/</tt> to deep mutational scanning counts files in <a class="reference external" href="https://github.com/jbloom/dms_tools">dms_tools</a> format. The counts files are in the directory <tt class="docutils literal">./processed_data/</tt>, and are for replicates 1 and 2 of selection on kanamycin.</li>
<li>Use the <a class="reference external" href="https://github.com/jbloom/dms_tools">dms_tools</a> program <tt class="docutils literal">dms_inferprefs</tt> to infer the site-specific preferences for each replicate of the experiment. The results are in <tt class="docutils literal">./processed_data/prefs_1.txt</tt> and <tt class="docutils literal">./processed_data/prefs_2.txt</tt>.</li>
<li>Use the <a class="reference external" href="https://github.com/jbloom/dms_tools">dms_tools</a> program <tt class="docutils literal">dms_merge</tt> to average the site-specific preferences from the two replicates to create <tt class="docutils literal">./processed_data/prefs.txt</tt>.</li>
<li>Use the <a class="reference external" href="https://github.com/jbloom/dms_tools">dms_tools</a> program <tt class="docutils literal">dms_logoplot</tt> to visually display the site-specific preferences with overlays showing secondary structure and relative solvent accessibility. This final visualization of the preferences is in the file <tt class="docutils literal">prefs_logoplot.pdf</tt>.</li>
</ol>
</blockquote>
<div class="figure align-center">
<img alt="prefs_logoplot.pdf" src="prefs_logoplot.pdf" style="width: 75%;" />
<p class="caption">The <tt class="docutils literal">prefs_logoplot.pdf</tt> visualization of the site-specific preferences from <a class="reference external" href="http://nar.oxfordjournals.org/content/42/14/e112">Melnikov et al (2014)</a> for selection on kanamycin.</p>
</div>
</div>
<div class="section" id="testing-of-inference-of-site-specific-preferences-on-simulated-data">
<h1><a class="toc-backref" href="#id4">Testing of inference of site-specific preferences on simulated data</a></h1>
<p>The subdirectory <tt class="docutils literal">./infer_prefs_on_simulated_data/</tt> simulates a deep mutational scanning experiment using the actual preferences for Tn5 inferred above. The deep mutational scanning experiment is simulated at a variety of per-site sequencing depths, and both with and without sequencing errors. The simulation is designed to be &quot;realistic&quot; in terms of the parameters. The simulated deep mutational scanning counts files are then analyzed to see how well the inferred preferences match those actually used in the simulation. The inferences are done in two ways:</p>
<blockquote>
<ol class="arabic simple">
<li>Using the statistical model implemented in <a class="reference external" href="https://github.com/jbloom/dms_tools">dms_tools</a> via the <tt class="docutils literal">dms_inferprefs</tt> program.</li>
<li>Simply by calculating enrichment ratios for mutations, and then rescaling these to preferences.</li>
</ol>
</blockquote>
<p>The analysis is run by the script <tt class="docutils literal">test_inferprefs.py</tt> via:</p>
<pre class="literal-block">
cd infer_prefs_on_simulated_data
python test_inferprefs.py
</pre>
<p>The results are shown in the plot below. Briefly, inference with <tt class="docutils literal">dms_inferprefs</tt> is superior to simply calculating enrichment ratios. The accuracy increases with increasing sequencing depth. Slightly more data is needed for accurate inferences when there are sequencing errors.</p>
<div class="figure align-center">
<img alt="infer_prefs_on_simulated_data/correlations.pdf" src="infer_prefs_on_simulated_data/correlations.pdf" style="width: 80%;" />
<p class="caption">Accuracy of the inference of site-specific preferences on simulated data.</p>
</div>
</div>
<div class="section" id="testing-of-inference-of-differential-preferences-on-simulated-data">
<h1><a class="toc-backref" href="#id5">Testing of inference of differential preferences on simulated data</a></h1>
<p>The subdirectory <tt class="docutils literal">./infer_diffprefs_on_simulated_data/</tt> simulates passaging an already functionally selected mutant library in two conditions: a control condition, and a condition that induces change in amino-acid preferences (differential preferences) at 20% of the residues. The <a class="reference external" href="https://github.com/jbloom/dms_tools">dms_tools</a> program <tt class="docutils literal">dms_inferdiffprefs</tt> is then used to analyze the simulated data to see how accurately it is possible to infer the differential preferences. This analysis can be run via:</p>
<pre class="literal-block">
cd infer_diffprefs_on_simulated_data
python test_inferdiffprefs.py
</pre>
<p>The results are shown below. With increasing read depth, the inferred differential preferences converge to the true values.</p>
<div class="figure align-center">
<img alt="infer_diffprefs_on_simulated_data/correlations.pdf" src="infer_diffprefs_on_simulated_data/correlations.pdf" style="width: 80%;" />
<p class="caption">Accuracy of inference of differential preferences on simulated data.</p>
</div>
<div class="figure align-center">
<img alt="infer_diffprefs_on_simulated_data/inferred_diffprefs_logoplot.pdf" src="infer_diffprefs_on_simulated_data/inferred_diffprefs_logoplot.pdf" style="width: 70%;" />
<p class="caption">Inferred differential preferences visualized with <tt class="docutils literal">dms_logoplot</tt> at a read depth of <span class="formula">10<sup>7</sup></span>
. Overlay bars show sites that actually had non-zero differential preferences in simulation.</p>
</div>
</div>
</div>
</body>
</html>
