<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Data file formats &mdash; dms_tools 1.1.17 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1.17',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="dms_tools 1.1.17 documentation" href="index.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="dms_summarizealignments" href="dms_summarizealignments.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="dms_summarizealignments.html" title="dms_summarizealignments"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">dms_tools 1.1.17 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="data-file-formats">
<h1><a class="toc-backref" href="#id2">Data file formats</a><a class="headerlink" href="#data-file-formats" title="Permalink to this headline">¶</a></h1>
<p>Below is information about the formats of the input and output files used by the <a class="reference internal" href="programs.html#programs"><span class="std std-ref">Programs</span></a> in <a class="reference external" href="http://jbloomlab.github.io/dms_tools">dms_tools</a>.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#data-file-formats" id="id2">Data file formats</a><ul>
<li><a class="reference internal" href="#deep-mutational-scanning-counts-file" id="id3">Deep mutational scanning counts file</a></li>
<li><a class="reference internal" href="#preferences-file" id="id4">Preferences file</a></li>
<li><a class="reference internal" href="#differential-preferences-file" id="id5">Differential preferences file</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="deep-mutational-scanning-counts-file">
<span id="dms-counts"></span><h2><a class="toc-backref" href="#id3">Deep mutational scanning counts file</a><a class="headerlink" href="#deep-mutational-scanning-counts-file" title="Permalink to this headline">¶</a></h2>
<p>The programs <a class="reference internal" href="dms_inferprefs.html#dms-inferprefs"><span class="std std-ref">dms_inferprefs</span></a> and <a class="reference internal" href="dms_inferdiffprefs.html#dms-inferdiffprefs"><span class="std std-ref">dms_inferdiffprefs</span></a> take their input data from files giving the counts of each possible character (codon, nucleotide, or amino acid) at each site in the gene. You will need to generate these files after using some other program to analyze your deep sequencing data.</p>
<p>Here is an example of the first few lines of a valid file giving nucleotide counts:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># POSITION WT A T C G</span>
<span class="mi">1</span> <span class="n">A</span> <span class="mi">310818</span> <span class="mi">13</span> <span class="mi">0</span> <span class="mi">37</span>
<span class="mi">2</span> <span class="n">T</span> <span class="mi">16</span> <span class="mi">311782</span> <span class="mi">37</span> <span class="mi">4</span>
<span class="mi">3</span> <span class="n">G</span> <span class="mi">27</span> <span class="mi">27</span> <span class="mi">11</span> <span class="mi">312520</span>
<span class="mi">4</span> <span class="n">A</span> <span class="mi">313647</span> <span class="mi">13</span> <span class="mi">4</span> <span class="mi">31</span>
</pre></div>
</div>
<p>A file giving codon counts would be structured similarly except rather than having the four nucleotide identities (<em>A</em>, <em>T</em>, <em>C</em>, <em>G</em>), the file should have the 64 codon identities (<em>AAA</em>, <em>AAC</em>, <em>AAG</em>, ...). A file giving amino-acid counts would have the 20 amino-acid identites, possibly including stop codons indicated by <code class="docutils literal"><span class="pre">*</span></code>. The file is allowed to have additional lines and columns, but they are ignored as detailed below. For instance, this file would be handled just like the one above (the additional lines and the columns for <em>a</em> and <em>N</em> would be ignored, and the different order of characters is fine, as is the additional space between columns):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Line ignored because it begins with # but isn&#39;t followed by POSITION WT</span>
<span class="c1">#</span>
<span class="c1"># The columns beginning with N and a are ignored since they don&#39;t start with an upper case nucleotide.</span>
<span class="c1"># The fact that the nucleotides are not in alphabetical order is irrelevant.</span>
<span class="c1"># POSITION WT G A T C N a</span>
<span class="mi">1</span> <span class="n">A</span> <span class="mi">37</span> <span class="mi">310818</span> <span class="mi">13</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">10</span>
<span class="mi">2</span> <span class="n">T</span> <span class="mi">4</span> <span class="mi">16</span> <span class="mi">311782</span> <span class="mi">37</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="c1"># The extra spaces between columns in the next line are irrelevant</span>
<span class="mi">3</span>  <span class="n">G</span>   <span class="mi">312520</span>   <span class="mi">27</span> <span class="mi">27</span>  <span class="mi">11</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">4</span> <span class="n">A</span> <span class="mi">31</span> <span class="mi">313647</span> <span class="mi">13</span> <span class="mi">4</span> <span class="mi">50</span> <span class="mi">49</span>
</pre></div>
</div>
<p>Specifically, the requirements for the file are as follows:</p>
<blockquote>
<div><ul>
<li><p class="first">Any lines beginning with <em>#</em> are treated as comments or headers, and do not contain data.</p>
</li>
<li><p class="first">Columns are space delimited. They can separated by one or more spaces, or by one or more tabs.</p>
</li>
<li><p class="first">Before the first data line (a line <strong>not</strong> beginning with <em>#</em>) there must be a header line beginning with <em># POSITION WT</em> and then followed in arbitrary order by entries specifying valid DNA nucleotides, valid DNA codons, or valid amino acids. The order of the entries in this header line establish the order of the data in the subsequent lines.</p>
</li>
<li><p class="first">The case does matter, all nucleotides, amino acids, and codons <strong>must be upper case</strong>.</p>
</li>
<li><p class="first">It is OK to intersperse columns that do not represent valid codons, amino acids, or nucleotides as long as all of the codons, amino acids, or nucleotides are present. This might be useful if you file is using <em>N</em> to denote ambiguous nucleotides (which are ignored as not being definitive counts), or is using lower-case letters (such as <em>a</em> to denote unsure calls).</p>
</li>
<li><p class="first">For every data line, the first two entries will be <em>POSITION</em> and <em>WT</em>:</p>
<blockquote>
<div><ul class="simple">
<li><em>POSITION</em> is the position number. These do not have to be consecutive integers, so it is OK to skip sites (e.g. <em>1</em>, <em>2</em>, <em>5</em>) or have negative site numbers (e.g. <em>-1</em>, <em>0</em>, <em>1</em>) or have sites with letter suffixes (e.g. <em>1</em>, <em>2</em>, <em>2A</em>, <em>3</em>). All of these options are useful when referring to numbering schemes that are non-sequential, as is sometimes the case in gene numbering. Note however that each position number must be unique.</li>
<li><em>WT</em> must give a valid wildtype identity of the site as a nucleotide, amino acid, or codon <strong>or</strong> be <em>?</em> if no wildtype is specified.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal"><span class="pre">*_codoncounts.txt</span></code> and <code class="docutils literal"><span class="pre">*_ntcounts.txt</span></code> files generated by <a class="reference external" href="http://jbloom.github.io/mapmuts">mapmuts</a> represent valid deep mutational scanning counts input files.</p>
</div>
<div class="section" id="preferences-file">
<span id="id1"></span><h2><a class="toc-backref" href="#id4">Preferences file</a><a class="headerlink" href="#preferences-file" title="Permalink to this headline">¶</a></h2>
<p>The program <a class="reference internal" href="dms_inferprefs.html#dms-inferprefs"><span class="std std-ref">dms_inferprefs</span></a> infers the site-specific preferences <span class="math">\(\pi_{r,x}\)</span> and writes these to a file. Here is an example of the format of one these preferences files for nucleotide characters:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># POSITION WT SITE_ENTROPY PI_A PI_C PI_G PI_T PI_A_95 PI_C_95 PI_G_95 PI_T_95</span>
<span class="mi">1</span> <span class="n">G</span> <span class="mf">1.61</span> <span class="mf">0.21</span> <span class="mf">0.09</span> <span class="mf">0.58</span> <span class="mf">0.12</span> <span class="mf">0.17</span><span class="p">,</span><span class="mf">0.28</span> <span class="mf">0.04</span><span class="p">,</span><span class="mf">0.12</span> <span class="mf">0.51</span><span class="p">,</span><span class="mf">0.69</span> <span class="mf">0.090</span><span class="p">,</span><span class="mf">0.150</span>
</pre></div>
</div>
<p>Specifically, there is a header line beginning with <code class="docutils literal"><span class="pre">#</span></code> that gives the column headers. Columns are whitespace delimited (by one more spaces or tabs). The columns are as follows:</p>
<blockquote>
<div><ul class="simple">
<li>The first column gives the position number, using the same number as in the <a class="reference internal" href="#dms-counts"><span class="std std-ref">Deep mutational scanning counts file</span></a> that were analyzed to infer the preferences.</li>
<li>The second column <code class="docutils literal"><span class="pre">WT</span></code> gives the wildtype identity at that site.</li>
<li>The third column gives the site entropy computed from the preferences in bits, using the formula <span class="math">\(h_r = -\sum\limits_x \pi_{r,x} \log_2 \pi_{r,x}\)</span> (so higher site entropies indicate sites that are tolerant of more amino acids).</li>
<li>The next sets of columns gives the preferences for each character (<code class="docutils literal"><span class="pre">PI_A</span></code> for <span class="math">\(\pi_{r,A}\)</span>, etc).</li>
<li>Optionally, there is a last set of columns gives the 95% median-centered credible interval for each preference, with the lower and upper bounds separated by a comma with no spaces.</li>
</ul>
</div></blockquote>
<p>If the preferences are for amino acids, the format is the same except there are now 20 or 21 columns of the form <code class="docutils literal"><span class="pre">PI_A</span></code>, <code class="docutils literal"><span class="pre">PI_C</span></code>, <code class="docutils literal"><span class="pre">PI_D</span></code>, etc. There are 20 if we are excluding stop codons, and 21 if we are including stop codons. Stop codons are indicated by <code class="docutils literal"><span class="pre">*</span></code>.</p>
<p>If the preferences are for codons, the format is the same except there are now 64 columns of the form <code class="docutils literal"><span class="pre">PI_AAA</span></code>, <code class="docutils literal"><span class="pre">PI_AAC</span></code>, <code class="docutils literal"><span class="pre">PI_AAG</span></code>, ..., <code class="docutils literal"><span class="pre">PI_TTG</span></code>, <code class="docutils literal"><span class="pre">PI_TTT</span></code>.</p>
<p>When the credible intervals are present, these columns are named <code class="docutils literal"><span class="pre">PI_A_95</span></code>, etc.</p>
</div>
<div class="section" id="differential-preferences-file">
<span id="diffpreferences-file"></span><h2><a class="toc-backref" href="#id5">Differential preferences file</a><a class="headerlink" href="#differential-preferences-file" title="Permalink to this headline">¶</a></h2>
<p>The program <a class="reference internal" href="dms_inferdiffprefs.html#dms-inferdiffprefs"><span class="std std-ref">dms_inferdiffprefs</span></a> infers the differential preferences <span class="math">\(\Delta\pi_{r,x}\)</span> and writes these to a file. Here is an example of the formate of one of these files for nucleotide characters:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># POSITION WT RMS_dPI dPI_A dPI_C dPI_G dPI_T Pr_dPI_A_lt0 Pr_dPI_A_gt0 Pr_dPI_C_lt0 Pr_dPI_C_gt0 Pr_dPI_G_lt0 Pr_dPI_G_gt0 Pr_dPI_T_lt0 Pr_dPI_T_gt0</span>
<span class="mi">1</span> <span class="n">G</span> <span class="mf">0.241</span> <span class="mf">0.02</span> <span class="o">-</span><span class="mf">0.4</span> <span class="mf">0.2</span> <span class="mf">0.18</span> <span class="mf">0.41</span> <span class="mf">0.59</span> <span class="mf">0.90</span> <span class="mf">0.10</span> <span class="mf">0.2</span> <span class="mf">0.8</span> <span class="mf">0.3</span> <span class="mf">0.7</span>
</pre></div>
</div>
<p>Specifically, there is a header line beginning with <code class="docutils literal"><span class="pre">#</span></code> that gives the column headers. Columns are whitespace delimited (by one or more spaces or tabs). The columns are as follows:</p>
<blockquote>
<div><ul class="simple">
<li>The first column gives the position number, using the same number as in the <a class="reference internal" href="#dms-counts"><span class="std std-ref">Deep mutational scanning counts file</span></a> that were analyzed to infer the preferences.</li>
<li>The second column <code class="docutils literal"><span class="pre">WT</span></code> gives the wildtype identity at the site <strong>or</strong> is <em>?</em> if no wildtype identity is specified.</li>
<li>The third column gives the root-mean-square differential preference for that site, <span class="math">\(\rm{RMS}_{\Delta\pi_r} = \sqrt{\frac{1}{\mathcal{N}_x}\sum\limits_x \left(\Delta\pi_{r,x}\right)^2}\)</span>.</li>
<li>The next set of columns gives the differential preferences for each character (<code class="docutils literal"><span class="pre">dPI_A</span></code> for <span class="math">\(\Delta\pi_{r,A}\)</span>, etc).</li>
<li>Optionally, there is a last set of columns giving the posterior probabilities that differential preferences are greater than zero (<code class="docutils literal"><span class="pre">Pr_dPI_gt0</span></code>) or less than zero (<code class="docutils literal"><span class="pre">Pr_dPI_lt0</span></code>).</li>
</ul>
</div></blockquote>
<p>If the differential preferences are for amino acids, the format is the same except there are now 20 or 21 columns of the form <code class="docutils literal"><span class="pre">dPI_A</span></code>, <code class="docutils literal"><span class="pre">dPI_C</span></code>, <code class="docutils literal"><span class="pre">dPI_D</span></code>, etc. There are 20 if we are excluding stop codons, and 21 if we are including stop codons. Stop codons are indicated by <code class="docutils literal"><span class="pre">*</span></code>.</p>
<p>If the preferences are for codons, the format is the same except there are now 64 columns of the form <code class="docutils literal"><span class="pre">dPI_AA</span></code>, <code class="docutils literal"><span class="pre">dPI_AAC</span></code>, <code class="docutils literal"><span class="pre">dPI_AAG</span></code>, ..., <code class="docutils literal"><span class="pre">dPI_TTG</span></code>, <code class="docutils literal"><span class="pre">dPI_TTT</span></code>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Data file formats</a><ul>
<li><a class="reference internal" href="#deep-mutational-scanning-counts-file">Deep mutational scanning counts file</a></li>
<li><a class="reference internal" href="#preferences-file">Preferences file</a></li>
<li><a class="reference internal" href="#differential-preferences-file">Differential preferences file</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="dms_summarizealignments.html"
                        title="previous chapter"><code class="docutils literal"><span class="pre">dms_summarizealignments</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="examples.html"
                        title="next chapter">Examples</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/fileformats.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="dms_summarizealignments.html" title="dms_summarizealignments"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">dms_tools 1.1.17 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Jesse Bloom.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.5.
    </div>
  </body>
</html>